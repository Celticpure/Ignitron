\hypertarget{_spark_b_l_e_control_8h_source}{}\doxysection{Spark\+BLEControl.\+h}
\mbox{\hyperlink{_spark_b_l_e_control_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * SparkBLEControl.h}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ *  Created on: 19.08.2021}}
\DoxyCodeLine{5 \textcolor{comment}{ *      Author: stangreg}}
\DoxyCodeLine{6 \textcolor{comment}{ */}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#ifndef SPARKBLECONTROL\_H\_}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#define SPARKBLECONTROL\_H\_}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <NimBLEDevice.h>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <Arduino.h>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_spark_data_control_8h}{SparkDataControl.h}}"{}}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{comment}{// Service and characteristics UUIDs of Spark Amp}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#define SPARK\_BLE\_SERVICE\_UUID "{}FFC0"{}}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define SPARK\_BLE\_WRITE\_CHAR\_UUID "{}FFC1"{}}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#define SPARK\_BLE\_NOTIF\_CHAR\_UUID "{}FFC2"{}}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{using} \mbox{\hyperlink{_spark_b_l_e_control_8h_a9ca15c3f786d188fb82ec188300346f3}{ByteVector}} = std::vector<byte>;}
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{class_spark_data_control}{SparkDataControl}};}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{comment}{// Forward declaration of Callbacks classes, does nothing special, only default actions}}
\DoxyCodeLine{26 \textcolor{keyword}{class }\mbox{\hyperlink{class_client_callbacks}{ClientCallbacks}}: \textcolor{keyword}{public} NimBLEClientCallbacks \{\};}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{class }\mbox{\hyperlink{class_spark_b_l_e_control}{SparkBLEControl}} : \textcolor{keyword}{public} NimBLEAdvertisedDeviceCallbacks, NimBLECharacteristicCallbacks, NimBLEServerCallbacks\{}
\DoxyCodeLine{29 \textcolor{keyword}{public}:}
\DoxyCodeLine{30     \mbox{\hyperlink{class_spark_b_l_e_control_a1dfa4b0f9bb204e2545ec49eea2dc877}{SparkBLEControl}}();}
\DoxyCodeLine{31     \mbox{\hyperlink{class_spark_b_l_e_control_a1dfa4b0f9bb204e2545ec49eea2dc877}{SparkBLEControl}}(\mbox{\hyperlink{class_spark_data_control}{SparkDataControl}}* dc);}
\DoxyCodeLine{32     \textcolor{keyword}{virtual} \mbox{\hyperlink{class_spark_b_l_e_control_a146f9ca774939f3890003f32aa0ac9d9}{\string~SparkBLEControl}}();}
\DoxyCodeLine{33     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_spark_b_l_e_control_a5cb06df732fb1dd7bb74fb8d22be3c46}{isConnectionFound}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} isConnectionFound\_;\}}
\DoxyCodeLine{34     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_spark_b_l_e_control_a09ab2d543cbd5864281ff9fc62b3fa79}{isConnected}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} isConnected\_;\}}
\DoxyCodeLine{35     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_spark_b_l_e_control_a8064d2e4673a20cb21c5c8970339b3ad}{connectToServer}}();}
\DoxyCodeLine{36     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_spark_b_l_e_control_a432b0b9efc5c94340ef76c95f2e5b89e}{subscribeToNotifications}}(notify\_callback notifyCallback=\textcolor{keyword}{nullptr});}
\DoxyCodeLine{37     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_spark_b_l_e_control_aff9085c1d7216700f4aa726db79a063a}{writeBLE}}(std::vector<ByteVector> cmd, \textcolor{keywordtype}{bool} response = \textcolor{keyword}{false});}
\DoxyCodeLine{38     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_spark_b_l_e_control_aba9084a82e8829c039cd7aca3348f7c2}{initBLE}}();}
\DoxyCodeLine{39     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_spark_b_l_e_control_ac69bc6917d49dc7ebe001a5d567e11e2}{initScan}}();}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_spark_b_l_e_control_a062a5d911df989d81806312968850b5d}{startServer}}();}
\DoxyCodeLine{42     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_spark_b_l_e_control_a064664de844bab60230ee276c3502ab1}{notifyClients}}(\mbox{\hyperlink{_spark_b_l_e_control_8h_a9ca15c3f786d188fb82ec188300346f3}{ByteVector}} msg);}
\DoxyCodeLine{43     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_spark_b_l_e_control_adaa43d506b8c9203d1a1772fed16aeea}{sendInitialNotification}}();}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{keyword}{private}:}
\DoxyCodeLine{46 }
\DoxyCodeLine{48     \textcolor{keyword}{static} \mbox{\hyperlink{class_client_callbacks}{ClientCallbacks}} clientCB;}
\DoxyCodeLine{49     NimBLEAdvertisedDevice *advDevice;}
\DoxyCodeLine{50     NimBLEClient *pClient = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{keywordtype}{bool} isConnected\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{53     \textcolor{keywordtype}{bool} isConnectionFound\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{54     uint32\_t scanTime = 0; }
\DoxyCodeLine{55     \textcolor{keyword}{const} uint8\_t notificationOn[2] = \{ 0x1, 0x0 \};}
\DoxyCodeLine{56 }
\DoxyCodeLine{57     \textcolor{keyword}{static} \textcolor{keywordtype}{void} scanEndedCB(NimBLEScanResults results);}
\DoxyCodeLine{58     \textcolor{keywordtype}{void} onResult(NimBLEAdvertisedDevice *advertisedDevice);}
\DoxyCodeLine{59     \textcolor{keywordtype}{void} setAdvertisedDevice(NimBLEAdvertisedDevice *device);}
\DoxyCodeLine{60 }
\DoxyCodeLine{61     \textcolor{comment}{// Server mode functions}}
\DoxyCodeLine{62     NimBLEServer *pServer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{63     \mbox{\hyperlink{class_spark_data_control}{SparkDataControl}}* spark\_dc;}
\DoxyCodeLine{64     \textcolor{keywordtype}{void} onWrite(NimBLECharacteristic* pCharacteristic);}
\DoxyCodeLine{65     \textcolor{keywordtype}{void} onSubscribe(NimBLECharacteristic* pCharacteristic, ble\_gap\_conn\_desc* desc, uint16\_t subValue);}
\DoxyCodeLine{66     \textcolor{keywordtype}{void} onConnect(NimBLEServer* pServer);}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* SPARKBLECONTROL\_H\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
